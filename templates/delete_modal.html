<div id="deleteConfirmModal" class="hidden fixed inset-0 z-50 w-full flex items-center justify-center bg-gray-800 bg-opacity-50">
  <div class="bg-white rounded-lg shadow-lg w-11/12 sm:w-1/3 max-h-screen">
    <div class="p-6">
      <h3 class="text-xl font-semibold text-gray-900">Confirm Deletion</h3>
      <p class="text-sm text-gray-600 mt-2">Are you sure you want to delete this product? This action cannot be undone.</p>
    </div>
    <div class="flex justify-end gap-4 p-4 border-t border-gray-200 rounded-b">
      <button type="button" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-md font-medium hover:bg-gray-50" onclick="hideDeleteModal()">
        Cancel
      </button>
      <button type="button" id="confirmDeleteButton" class="px-6 py-2 bg-red-600 text-white rounded-md font-medium hover:bg-red-700">
        Delete
      </button>
    </div>
  </div>
</div>

<script>
let deleteUrlToConfirm = null; 

function showDeleteModal(deleteUrl) {
    deleteUrlToConfirm = deleteUrl; 
    document.getElementById('deleteConfirmModal').classList.remove('hidden');
}

function hideDeleteModal() {
    deleteUrlToConfirm = null;
    document.getElementById('deleteConfirmModal').classList.add('hidden');
}

document.getElementById('confirmDeleteButton').addEventListener('click', async () => {
    if (deleteUrlToConfirm) {
        try {
            await fetch(deleteUrlToConfirm, {
                method: "POST", 
                headers: { "X-CSRFToken": getCookie('csrftoken') }
            });
            
            hideDeleteModal();
            showToast('Product deleted!', '', 'error');
            document.dispatchEvent(new CustomEvent('productAdded')); 
        } catch (error) {
            console.error('Failed to delete product:', error);
            showToast('Failed to delete product.', '', 'error');
            hideDeleteModal();
        }
    }
});
</script>